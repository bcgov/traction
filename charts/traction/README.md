# Traction

![version: 0.4.0](https://img.shields.io/badge/Version-0.4.0-informational?style=flat-square) ![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![AppVersion: 1.2.0](https://img.shields.io/badge/AppVersion-1.2.0-informational?style=flat-square)

The Traction service allows organizations to verify, hold, and issue verifiable credentials.

**Homepage:** <https://github.com/bcgov/traction>

## TL;DR

```console
helm repo add traction https://bcgov.github.io/traction
helm install my-release traction/traction
```

## Prerequisites

- Kubernetes 1.19+
- Helm 3.2.0+
- PV provisioner support in the underlying infrastructure

## Installing the Chart

To install the chart with the release name `my-release`:

```console
helm repo add traction https://bcgov.github.io/traction
helm install my-release traction/traction
```

The command deploys Traction and PostgrSQL on the Kubernetes cluster in the default configuration. The [Parameters](#parameters) section lists the parameters that can be configured during installation.

> **Tip**: List all releases using `helm list`

## Uninstalling the Chart

To uninstall/delete the `my-release` deployment:

```console
helm delete my-release
```

The command removes all the Kubernetes components but secrets and PVC's associated with the chart and deletes the release.

To delete the secrets and PVC's associated with `my-release`:

```console
kubectl delete secret,pvc --selector "app.kubernetes.io/instance"=my-release
```

> **Note**: Deleting the PVC's will delete postgresql data as well. Please be cautious before doing it.

## Parameters

### ACA-Py configuration file

| Name                                                    | Description                                                                                                                                                                                                                                                                                                                                                                                         | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| ------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `acapy.argfile.yml.auto-accept-invites`                 | Automatically accept invites without firing a webhook event or waiting for an admin request. Default: false.                                                                                                                                                                                                                                                                                        | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-accept-requests`                | Automatically accept connection requests without firing a webhook event or waiting for an admin request. Default: false.                                                                                                                                                                                                                                                                            | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-create-revocation-transactions` | For Authors, specify whether to automatically create transactions for a cred def's revocation registry. (If not specified, the controller must invoke the endpoints required to create the revocation registry and assign to the cred def.)                                                                                                                                                         | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-ping-connection`                | Automatically send a trust ping immediately after a connection response is accepted. Some agents require this before marking a connection as 'active'. Default: false.                                                                                                                                                                                                                              | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-promote-author-did`             | For authors, specify whether to automatically promote a DID to the wallet public DID after writing to the ledger.``                                                                                                                                                                                                                                                                                 | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-provision`                      | If the requested profile does not exist, initialize it with the given parameters.                                                                                                                                                                                                                                                                                                                   | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-request-endorsement`            | For Authors, specify whether to automatically request endorsement for all transactions. (If not specified, the controller must invoke the request endorse operation for each transaction.)                                                                                                                                                                                                          | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-respond-credential-offer`       | Automatically respond to Indy credential offers with a credential request. Default: false                                                                                                                                                                                                                                                                                                           | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.argfile.yml.auto-respond-credential-proposal`    | Auto-respond to credential proposals with corresponding credential offers.                                                                                                                                                                                                                                                                                                                          | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.argfile.yml.auto-respond-credential-request`     | Auto-respond to credential requests with corresponding credentials.                                                                                                                                                                                                                                                                                                                                 | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-respond-messages`               | Automatically respond to basic messages indicating the message was received. Default: false.                                                                                                                                                                                                                                                                                                        | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-respond-presentation-proposal`  | Auto-respond to presentation proposals with corresponding presentation requests.                                                                                                                                                                                                                                                                                                                    | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-respond-presentation-request`   | Automatically respond to Indy presentation requests with a constructed presentation if a corresponding credential can be retrieved for every referent in the presentation request. Default: false.                                                                                                                                                                                                  | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.argfile.yml.auto-store-credential`               | Automatically store an issued credential upon receipt. Default: false.                                                                                                                                                                                                                                                                                                                              | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-verify-presentation`            | Automatically verify a presentation when it is received. Default: false.                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.auto-write-transactions`             | For Authors, specify whether to automatically write any endorsed transactions. (If not specified, the controller must invoke the write transaction operation for each transaction.)                                                                                                                                                                                                                 | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.emit-new-didcomm-mime-type`          | Send packed agent messages with the DIDComm MIME type as of RFC 0044; i.e., 'application/didcomm-envelope-enc' instead of 'application/ssi-agent-wire'.                                                                                                                                                                                                                                             | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.emit-new-didcomm-prefix`             | Emit protocol messages with new DIDComm prefix; i.e., 'https://didcomm.org/' instead of (default) prefix 'did:sov:BzCbsNYhMrjHiqZDTUASHg;spec/'.                                                                                                                                                                                                                                                    | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.endorser-alias`                      | For transaction Authors, specify the alias of the Endorser connection that will be used to endorse transactions.                                                                                                                                                                                                                                                                                    | `endorser`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
| `acapy.argfile.yml.endorser-protocol-role`              | Specify the role ('author' or 'endorser') which this agent will participate. Authors will request transaction endorement from an Endorser. Endorsers will endorse transactions from Authors, and may write their own  transactions to the ledger. If no role (or 'none') is specified then the endorsement protocol will not be used and this agent will write transactions to the ledger directly. | `author`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| `acapy.argfile.yml.log-level`                           | Specifies a custom logging level as one of: ('debug', 'info', 'warning', 'error', 'critical')                                                                                                                                                                                                                                                                                                       | `info`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.monitor-ping`                        | Send a webhook when a ping is sent or received.                                                                                                                                                                                                                                                                                                                                                     | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.monitor-revocation-notification`     | Specifies that aca-py will emit webhooks on notification of revocation received.                                                                                                                                                                                                                                                                                                                    | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.multitenant-admin`                   | Specify whether to enable the multitenant admin api.                                                                                                                                                                                                                                                                                                                                                | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.multitenant`                         | Enable multitenant mode.                                                                                                                                                                                                                                                                                                                                                                            | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.notify-revocation`                   | Specifies that aca-py will notify credential recipients when revoking a credential it issued.                                                                                                                                                                                                                                                                                                       | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.preserve-exchange-records`           | Keep credential exchange records after exchange has completed.                                                                                                                                                                                                                                                                                                                                      | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.public-invites`                      | Send invitations out using the public DID for the agent, and receive connection requests solicited by invitations which use the public DID. Default: false.                                                                                                                                                                                                                                         | `true`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
| `acapy.argfile.yml.read-only-ledger`                    | Sets ledger to read-only to prevent updates. Default: false.                                                                                                                                                                                                                                                                                                                                        | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.argfile.yml.tails-server-base-url`               | Sets the base url of the tails server in use.                                                                                                                                                                                                                                                                                                                                                       | `https://tails-test.vonx.io`                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `acapy.argfile.yml.tails-server-upload-url`             | Sets the base url of the tails server for upload, defaulting to the tails server base url.                                                                                                                                                                                                                                                                                                          | `https://tails-test.vonx.io`                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| `acapy.argfile.yml.wallet-name`                         | Specifies the wallet name to be used by the agent. This is useful if your deployment has multiple wallets.                                                                                                                                                                                                                                                                                          | `askar-wallet`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
| `acapy.argfile.yml.wallet-storage-type`                 | Specifies the type of Indy wallet backend to use. Supported internal storage types are 'basic' (memory), 'default' (sqlite), and 'postgres_storage'.  The default, if not specified, is 'default'.                                                                                                                                                                                                  | `postgres_storage`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| `acapy.argfile.yml.wallet-type`                         | Specifies the type of Indy wallet provider to use. Supported internal storage types are 'basic' (memory) and 'indy'. The default (if not specified) is 'basic'.                                                                                                                                                                                                                                     | `askar`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.argfile.yml.webhook-url`                         | Send webhooks containing internal state changes to the specified URL. Optional API key to be passed in the request body can be appended using a hash separator [#]. This is useful for a controller to monitor agent events and respond to those events using the admin API. If not specified, webhooks are not published by the agent.                                                             | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.ingress.agent.enabled`                           | Enable ingress for the agent endpoint                                                                                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.ingress.agent.hostname`                          | Hostname to expose the agent endpoint                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.ingress.admin.enabled`                           | Enable ingress for the admin endpoint                                                                                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.ingress.admin.hostname`                          | Hostname to expose the admin endpoint                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.agentUrl`                                        | Override the agent URL advertised by ACA-Py                                                                                                                                                                                                                                                                                                                                                         | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.adminUrl`                                        | Override the admin URL for internal access                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.extraEnvVars`                                    | Extra environment variables to add to the container (array of objects)                                                                                                                                                                                                                                                                                                                              | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.extraEnvVarsCM`                                  | Name of an existing ConfigMap with extra env vars                                                                                                                                                                                                                                                                                                                                                   | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.extraEnvVarsSecret`                              | Name of an existing Secret with extra env vars (required for innkeeper plugin)                                                                                                                                                                                                                                                                                                                      | `innkeeper-secret-name`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.websockets.enabled`                              | Enable WebSocket transport for ACA-Py                                                                                                                                                                                                                                                                                                                                                               | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.extraArgs`                                       | Additional CLI args appended to the aca-py start command                                                                                                                                                                                                                                                                                                                                            | `["--plugin 'aries_cloudagent.messaging.jsonld'","--plugin traction_plugins.traction_innkeeper.v1_0","--plugin-config-value traction_innkeeper.innkeeper_wallet.tenant_id=\\\"$(INNKEEPER_WALLET_TENANT_ID)\\\"","--plugin-config-value traction_innkeeper.innkeeper_wallet.wallet_key=\\\"$(INNKEEPER_WALLET_WALLET_KEY)\\\"","--plugin multitenant_provider.v1_0","--plugin basicmessage_storage.v1_0","--plugin connections","--plugin connection_update.v1_0","--plugin rpc.v1_0","--plugin webvh"]` |
| `acapy.initContainers`                                  | Extra init containers to add to the pod (array of objects)                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.extraVolumes`                                    | Extra volumes to add to the pod                                                                                                                                                                                                                                                                                                                                                                     | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.extraVolumeMounts`                               | Extra volumeMounts to add to the main container                                                                                                                                                                                                                                                                                                                                                     | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.updateStrategy`                                  | Custom update strategy for the Deployment                                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.commonLabels`                                    | Additional common labels to add to all ACA-Py resources                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.commonAnnotations`                               | Additional common annotations to add to all ACA-Py resources                                                                                                                                                                                                                                                                                                                                        | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.automountServiceAccountToken`                    | Automount service account token for the ACA-Py pod                                                                                                                                                                                                                                                                                                                                                  | `false`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| `acapy.nodeAffinityPreset.type`                         | Node affinity preset type (soft|hard|empty)                                                                                                                                                                                                                                                                                                                                                         | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.nodeAffinityPreset.key`                          | Node label key for node affinity preset                                                                                                                                                                                                                                                                                                                                                             | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.nodeAffinityPreset.values`                       | Node label values for node affinity preset                                                                                                                                                                                                                                                                                                                                                          | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.podAffinityPreset`                               | Pod affinity preset (soft|hard|empty)                                                                                                                                                                                                                                                                                                                                                               | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.podAntiAffinityPreset`                           | Pod anti-affinity preset (soft|hard|empty)                                                                                                                                                                                                                                                                                                                                                          | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.topologySpreadConstraints`                       | Pod topology spread constraints                                                                                                                                                                                                                                                                                                                                                                     | `[]`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.existingConfigmap`                               | Name of an existing ConfigMap providing argfile.yml and other config                                                                                                                                                                                                                                                                                                                                | `""`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| `acapy.ledgers.yml`                                     | YAML configuration for connecting to multiple HyperLedger                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

### ACA-Py Plugin Configuration

| Name                                                                                    | Description | Value                                                                 |
| --------------------------------------------------------------------------------------- | ----------- | --------------------------------------------------------------------- |
| `acapy.plugin-config.yml.multitenant_provider.manager.class_name`                       |             | `multitenant_provider.v1_0.manager.AskarMultitokenMultitenantManager` |
| `acapy.plugin-config.yml.multitenant_provider.manager.always_check_provided_wallet_key` |             | `true`                                                                |
| `acapy.plugin-config.yml.multitenant_provider.errors.on_unneeded_wallet_key`            |             | `false`                                                               |
| `acapy.plugin-config.yml.multitenant_provider.token_expiry.units`                       |             | `days`                                                                |
| `acapy.plugin-config.yml.multitenant_provider.token_expiry.amount`                      |             | `1`                                                                   |
| `acapy.plugin-config.yml.traction_innkeeper.innkeeper_wallet.wallet_name`               |             | `traction_innkeeper`                                                  |
| `acapy.plugin-config.yml.traction_innkeeper.innkeeper_wallet.print_key`                 |             | `false`                                                               |
| `acapy.plugin-config.yml.traction_innkeeper.innkeeper_wallet.print_token`               |             | `false`                                                               |
| `acapy.plugin-config.yml.traction_innkeeper.innkeeper_wallet.connect_to_endorser`       |             | `[]`                                                                  |
| `acapy.plugin-config.yml.traction_innkeeper.innkeeper_wallet.create_public_did`         |             | `[]`                                                                  |
| `acapy.plugin-config.yml.traction_innkeeper.reservation.expiry_minutes`                 |             | `2880`                                                                |
| `acapy.plugin-config.yml.traction_innkeeper.reservation.auto_approve`                   |             | `false`                                                               |
| `acapy.plugin-config.yml.traction_innkeeper.reservation.auto_issuer`                    |             | `false`                                                               |
| `acapy.plugin-config.yml.basicmessage_storage.wallet_enabled`                           |             | `true`                                                                |

### ACA-Py common configurations

| Name                              | Description                                    | Value   |
| --------------------------------- | ---------------------------------------------- | ------- |
| `acapy.resources.requests.memory` | The requested memory for the ACA-Py containers | `200Mi` |
| `acapy.resources.requests.cpu`    | The requested cpu for the ACA-Py containers    | `120m`  |
| `acapy.service.ports.http`        | Port to expose for http service                | `8021`  |
| `acapy.service.ports.admin`       | Port to expose for admin service               | `8022`  |
| `acapy.service.ports.ws`          | Port to expose for websocket service           | `8023`  |

### ACA-Py NetworkPolicy parameters

| Name                                        | Description                                                                  | Value   |
| ------------------------------------------- | ---------------------------------------------------------------------------- | ------- |
| `acapy.networkPolicy.enabled`               | Enable network policies                                                      | `false` |
| `acapy.networkPolicy.allowExternal`         | Allow ingress from any source (disables from selectors when true)            | `false` |
| `acapy.networkPolicy.allowExternalEgress`   | Allow all egress traffic (when false, only DNS and extraEgress are applied)  | `true`  |
| `acapy.networkPolicy.extraIngress`          | Extra ingress rules to append (raw NetworkPolicy rule objects)               | `[]`    |
| `acapy.networkPolicy.extraEgress`           | Extra egress rules to append (raw NetworkPolicy rule objects)                | `[]`    |
| `acapy.networkPolicy.ingressPodMatchLabels` | Additional pod matchLabels to allow ingress from (merged with common labels) | `{}`    |
| `acapy.networkPolicy.ingressNSMatchLabels`  | Additional namespace matchLabels to allow ingress from                       | `{}`    |
| `acapy.existingSecret`                      | Deprecated. Use acapy.secret.*.existingSecret instead.                       | `""`    |

### Tenant Proxy configuration

| Name                                                         | Description                                                                                                         | Value                                 |
| ------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------- | ------------------------------------- |
| `tenant_proxy.image.repository`                              |                                                                                                                     | `ghcr.io/bcgov/traction-tenant-proxy` |
| `tenant_proxy.image.pullPolicy`                              |                                                                                                                     | `IfNotPresent`                        |
| `tenant_proxy.image.pullSecrets`                             |                                                                                                                     | `[]`                                  |
| `tenant_proxy.image.tag`                                     | Overrides the image tag which defaults to the chart appVersion.                                                     | `""`                                  |
| `tenant_proxy.serviceAccount.create`                         | Specifies whether a ServiceAccount should be created                                                                | `false`                               |
| `tenant_proxy.serviceAccount.annotations`                    | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                          | `{}`                                  |
| `tenant_proxy.serviceAccount.automountServiceAccountToken`   | Automount service account token for the server service account                                                      | `true`                                |
| `tenant_proxy.serviceAccount.name`                           | Name of the service account to use. If not set and create is true, a name is generated using the fullname template. | `""`                                  |
| `tenant_proxy.replicaCount`                                  | Number of Tenant proxy replicas to deploy. Ignored if autoscaling is enabled.                                       | `1`                                   |
| `tenant_proxy.autoscaling.enabled`                           | Enable Horizontal POD autoscaling for Tenant proxy                                                                  | `false`                               |
| `tenant_proxy.autoscaling.minReplicas`                       | Minimum number of Tenant proxy replicas                                                                             | `1`                                   |
| `tenant_proxy.autoscaling.maxReplicas`                       | Maximum number of Tenant proxy replicas                                                                             | `3`                                   |
| `tenant_proxy.autoscaling.targetCPUUtilizationPercentage`    | Target CPU utilization percentage                                                                                   | `80`                                  |
| `tenant_proxy.autoscaling.targetMemoryUtilizationPercentage` | Target Memory utilization percentage                                                                                | `80`                                  |
| `tenant_proxy.autoscaling.stabilizationWindowSeconds`        | Stabilization window in seconds                                                                                     | `300`                                 |
| `tenant_proxy.podAnnotations`                                | Map of annotations to add to the Tenant proxy pods                                                                  | `{}`                                  |
| `tenant_proxy.podSecurityContext`                            | Pod Security Context                                                                                                | `{}`                                  |
| `tenant_proxy.containerSecurityContext`                      | Container Security Context                                                                                          | `{}`                                  |
| `tenant_proxy.service.type`                                  | Kubernetes Service type                                                                                             | `ClusterIP`                           |
| `tenant_proxy.service.port`                                  | Port to expose for http services                                                                                    | `8032`                                |

### Tenant proxy OpenShift Route parameters

| Name                                                             | Description                                                       | Value   |
| ---------------------------------------------------------------- | ----------------------------------------------------------------- | ------- |
| `tenant_proxy.openshift.route.enabled`                           | Create OpenShift Route resource for Tenant proxy                  | `false` |
| `tenant_proxy.openshift.route.path`                              | Path that the router watches for, to route traffic to the service | `/`     |
| `tenant_proxy.openshift.route.targetPort`                        | Target port for the service                                       | `http`  |
| `tenant_proxy.openshift.route.timeout`                           | Timeout in seconds for a route to return                          | `2m`    |
| `tenant_proxy.openshift.route.tls.enabled`                       | Enable TLS termination                                            | `true`  |
| `tenant_proxy.openshift.route.tls.insecureEdgeTerminationPolicy` | TLS termination policy                                            | `None`  |
| `tenant_proxy.openshift.route.tls.termination`                   | TLS termination type                                              | `edge`  |
| `tenant_proxy.openshift.route.wildcardPolicy`                    | Wildcard policy for the route                                     | `None`  |
| `tenant_proxy.resources.requests.memory`                         | The requested memory for the Tenant proxy containers              | `50Mi`  |
| `tenant_proxy.resources.requests.cpu`                            | The requested cpu for the Tenant proxy containers                 | `10m`   |

### Tenant Proxy NetworkPolicy parameters

| Name                                                   | Description                                                               | Value   |
| ------------------------------------------------------ | ------------------------------------------------------------------------- | ------- |
| `tenant_proxy.networkPolicy.enabled`                   | Enable network policies                                                   | `false` |
| `tenant_proxy.networkPolicy.ingress.enabled`           | Enable ingress rules                                                      | `true`  |
| `tenant_proxy.networkPolicy.ingress.namespaceSelector` | Namespace selector label that is allowed to access the Tenant proxy pods. | `{}`    |
| `tenant_proxy.networkPolicy.ingress.podSelector`       | Pod selector label that is allowed to access the Tenant proxy pods.       | `{}`    |
| `tenant_proxy.affinity`                                | Affinity for ACA-Py pods assignment                                       | `{}`    |
| `tenant_proxy.nodeSelector`                            | Node labels for ACA-Py pods assignment                                    | `{}`    |
| `tenant_proxy.tolerations`                             | Tolerations for ACA-Py pods assignment                                    | `[]`    |

### Tenant-UI Configuration

| Name                                               | Description                                                                                                                                                                                                                                                | Value                                                                          |
| -------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
| `ui.enabled`                                       | Deploy tenant-ui                                                                                                                                                                                                                                           | `true`                                                                         |
| `ui.showOIDCReservationLogin`                      | OIDC reservation login                                                                                                                                                                                                                                     | `false`                                                                        |
| `ui.quickConnectEndorserName`                      | A ledger that has endorser auto-accept/transact enabled                                                                                                                                                                                                    | `""`                                                                           |
| `ui.requireEmailForReservation`                    | Whether the Email field is needed for a tenant reservation                                                                                                                                                                                                 | `true`                                                                         |
| `ui.lokiUrl`                                       | The endpoint to stream loki logs from for the Tenant UI                                                                                                                                                                                                    | `""`                                                                           |
| `ui.image.repository`                              |                                                                                                                                                                                                                                                            | `ghcr.io/bcgov/traction-tenant-ui`                                             |
| `ui.image.pullPolicy`                              |                                                                                                                                                                                                                                                            | `IfNotPresent`                                                                 |
| `ui.image.pullSecrets`                             |                                                                                                                                                                                                                                                            | `[]`                                                                           |
| `ui.image.tag`                                     | Overrides the image tag which defaults to the chart appVersion.                                                                                                                                                                                            | `""`                                                                           |
| `ui.existingSecret`                                | Name of an existing secret to be mounted as environment variables                                                                                                                                                                                          | `""`                                                                           |
| `ui.ux.appTitle`                                   | Title of the application                                                                                                                                                                                                                                   | `Traction Tenant Console`                                                      |
| `ui.ux.appInnkeeperTitle`                          | Title of the Innkeeper Console                                                                                                                                                                                                                             | `Traction Innkeeper Console`                                                   |
| `ui.ux.sidebarTitle`                               | Sidebar title                                                                                                                                                                                                                                              | `Traction`                                                                     |
| `ui.ux.copyright`                                  |                                                                                                                                                                                                                                                            | `""`                                                                           |
| `ui.ux.owner`                                      |                                                                                                                                                                                                                                                            | `""`                                                                           |
| `ui.ux.coverImageCopyright`                        |                                                                                                                                                                                                                                                            | `Photo by Kristoffer Fredriksson on StockSnap`                                 |
| `ui.ux.aboutBusiness.title`                        |                                                                                                                                                                                                                                                            | `Government of British Columbia`                                               |
| `ui.ux.aboutBusiness.linkTitle`                    |                                                                                                                                                                                                                                                            | `BC Digital Trust Service Agreement`                                           |
| `ui.ux.aboutBusiness.link`                         |                                                                                                                                                                                                                                                            | `https://github.com/bcgov/bc-vcpedia/blob/main/agents/bc-gov-agent-service.md` |
| `ui.ux.aboutBusiness.imageUrl`                     |                                                                                                                                                                                                                                                            | `/img/bc/bc_logo.png`                                                          |
| `ui.ux.infoBanner.message`                         |                                                                                                                                                                                                                                                            | `""`                                                                           |
| `ui.ux.infoBanner.messageLevel`                    | <info|warn|error|success>                                                                                                                                                                                                                                  | `info`                                                                         |
| `ui.ux.infoBanner.showMessage`                     | Show the info banner <boolean>                                                                                                                                                                                                                             | `false`                                                                        |
| `ui.oidc.showInnkeeperAdminLogin`                  | Show Innkeeper Admin Login                                                                                                                                                                                                                                 | `true`                                                                         |
| `ui.oidc.showWritableComponents`                   | Show writable components                                                                                                                                                                                                                                   | `true`                                                                         |
| `ui.oidc.active`                                   | Enable OIDC authentication                                                                                                                                                                                                                                 | `true`                                                                         |
| `ui.oidc.authority`                                | OIDC authority                                                                                                                                                                                                                                             | `""`                                                                           |
| `ui.oidc.client`                                   | OIDC client                                                                                                                                                                                                                                                | `innkeeper-frontend`                                                           |
| `ui.oidc.label`                                    | OIDC label                                                                                                                                                                                                                                                 | `IDIR`                                                                         |
| `ui.oidc.jwksUri`                                  | OIDC jwksUri                                                                                                                                                                                                                                               | `""`                                                                           |
| `ui.oidc.realm`                                    | OIDC realm                                                                                                                                                                                                                                                 | `Traction`                                                                     |
| `ui.oidc.roleName`                                 | OIDC role name                                                                                                                                                                                                                                             | `innkeeper`                                                                    |
| `ui.oidc.session.timeoutSeconds`                   | OIDC session timeout seconds                                                                                                                                                                                                                               | `600`                                                                          |
| `ui.oidc.session.countdownSeconds`                 | OIDC session countdown seconds                                                                                                                                                                                                                             | `30`                                                                           |
| `ui.oidc.reservationForm`                          |                                                                                                                                                                                                                                                            | `{}`                                                                           |
| `ui.oidc.extraQueryParams`                         |                                                                                                                                                                                                                                                            | `{}`                                                                           |
| `ui.smtp.server`                                   | SMTP server                                                                                                                                                                                                                                                | `""`                                                                           |
| `ui.smtp.port`                                     | SMTP port                                                                                                                                                                                                                                                  | `25`                                                                           |
| `ui.smtp.secure`                                   | if true the connection will use TLS when connecting to server. If false (the default) then TLS is used if server supports the STARTTLS extension. In most cases set this value to true if you are connecting to port 465. For port 587 or 25 keep it false | `false`                                                                        |
| `ui.smtp.user`                                     | SMTP user (use ui.existingSecret to provide SERVER_SMTP_PASSWORD)                                                                                                                                                                                          | `""`                                                                           |
| `ui.smtp.senderAddress`                            | SMTP sender address                                                                                                                                                                                                                                        | `""`                                                                           |
| `ui.smtp.innkeeperInbox`                           | innkeeper notification inbox                                                                                                                                                                                                                               | `""`                                                                           |
| `ui.serviceAccount.create`                         | Specifies whether a ServiceAccount should be created                                                                                                                                                                                                       | `false`                                                                        |
| `ui.serviceAccount.annotations`                    | Annotations for service account. Evaluated as a template. Only used if `create` is `true`.                                                                                                                                                                 | `{}`                                                                           |
| `ui.serviceAccount.automountServiceAccountToken`   | Automount service account token for the server service account                                                                                                                                                                                             | `true`                                                                         |
| `ui.serviceAccount.name`                           | Name of the service account to use. If not set and create is true, a name is generated using the fullname template.                                                                                                                                        | `""`                                                                           |
| `ui.podAnnotations`                                | Map of annotations to add to the pods                                                                                                                                                                                                                      | `{}`                                                                           |
| `ui.podSecurityContext`                            | Pod Security Context                                                                                                                                                                                                                                       | `{}`                                                                           |
| `ui.containerSecurityContext`                      | Container Security Context                                                                                                                                                                                                                                 | `{}`                                                                           |
| `ui.service.type`                                  | Kubernetes Service type                                                                                                                                                                                                                                    | `ClusterIP`                                                                    |
| `ui.service.httpPort`                              | Port to expose for http service                                                                                                                                                                                                                            | `8080`                                                                         |
| `ui.networkPolicy.enabled`                         | Enable network policies                                                                                                                                                                                                                                    | `false`                                                                        |
| `ui.networkPolicy.ingress.enabled`                 | Enable ingress rules                                                                                                                                                                                                                                       | `false`                                                                        |
| `ui.networkPolicy.ingress.namespaceSelector`       | Namespace selector label that is allowed to access the tenant-ui pods.                                                                                                                                                                                     | `{}`                                                                           |
| `ui.networkPolicy.ingress.podSelector`             | Pod selector label that is allowed to access the tenant-ui pods.                                                                                                                                                                                           | `{}`                                                                           |
| `ui.resources.requests.memory`                     | The requested memory for the tenant-ui containers                                                                                                                                                                                                          | `80Mi`                                                                         |
| `ui.resources.requests.cpu`                        | The requested cpu for the tenant-ui containers                                                                                                                                                                                                             | `10m`                                                                          |
| `ui.replicaCount`                                  | Number of tenant-ui replicas to deploy. Ignored if autoscaling is enabled.                                                                                                                                                                                 | `1`                                                                            |
| `ui.autoscaling.enabled`                           | Enable Horizontal POD autoscaling for tenant-ui                                                                                                                                                                                                            | `false`                                                                        |
| `ui.autoscaling.minReplicas`                       | Minimum number of tenant-ui replicas                                                                                                                                                                                                                       | `1`                                                                            |
| `ui.autoscaling.maxReplicas`                       | Maximum number of tenant-ui replicas                                                                                                                                                                                                                       | `3`                                                                            |
| `ui.autoscaling.targetCPUUtilizationPercentage`    | Target CPU utilization percentage                                                                                                                                                                                                                          | `80`                                                                           |
| `ui.autoscaling.targetMemoryUtilizationPercentage` | Target Memory utilization percentage                                                                                                                                                                                                                       | `80`                                                                           |
| `ui.nodeSelector`                                  | Node labels for tenant-ui pods assignment                                                                                                                                                                                                                  | `{}`                                                                           |
| `ui.tolerations`                                   | Tolerations for tenant-ui pods assignment                                                                                                                                                                                                                  | `[]`                                                                           |
| `ui.affinity`                                      | Affinity for tenant-ui pods assignment                                                                                                                                                                                                                     | `{}`                                                                           |

### Tenant-UI OpenShift Route parameters

| Name                                                   | Description                                                       | Value   |
| ------------------------------------------------------ | ----------------------------------------------------------------- | ------- |
| `ui.openshift.route.enabled`                           | Create OpenShift Route resource for tenant-ui                     | `false` |
| `ui.openshift.route.path`                              | Path that the router watches for, to route traffic to the service | `/`     |
| `ui.openshift.route.targetPort`                        | Target port for the service                                       | `http`  |
| `ui.openshift.route.timeout`                           | Timeout in seconds for a route to return                          | `2m`    |
| `ui.openshift.route.tls.enabled`                       | Enable TLS termination                                            | `true`  |
| `ui.openshift.route.tls.insecureEdgeTerminationPolicy` | TLS termination policy                                            | `None`  |
| `ui.openshift.route.tls.termination`                   | TLS termination type                                              | `edge`  |
| `ui.openshift.route.wildcardPolicy`                    | Wildcard policy for the route                                     | `None`  |

### Ingress Configuration

| Name                  | Description                                                                   | Value   |
| --------------------- | ----------------------------------------------------------------------------- | ------- |
| `ingress.enabled`     | Enable ingress record generation for traction                                 | `false` |
| `ingress.className`   | IngressClass that will be be used to implement the Ingress (Kubernetes 1.18+) | `""`    |
| `ingress.annotations` | Additional annotations for the Ingress resource.                              | `{}`    |
| `ingress.tls`         | Enable TLS configuration for the host defined at ingress.                     | `[]`    |

## Maintainers

| Name            | Email                         | Url                                  |
| --------------- | ----------------------------- | ------------------------------------ |
| i5okie          | <ivan.polchenko@quartech.com> | <https://github.com/i5okie>          |
| usingtechnology | <tools@usingtechnolo.gy>      | <https://github.com/usingtechnology> |
| Jsyro           | <jason.syrotuck@nttdata.com>  | <https://github.com/Jsyro>           |
| esune           | <emiliano.sune@quartech.com>  | <https://github.com/esune>           |

## License

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

<https://github.com/bcgov/traction/blob/main/LICENSE>

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
